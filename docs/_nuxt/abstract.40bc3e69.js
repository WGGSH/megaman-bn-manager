import{_ as be}from"./accept.d63b17f3.js";import{a as X,r as d,o as I,c as Y,w as a,b as Ne,e as ke,f as Se,h as ze,i as Ie,j as p,k as m,l as O,m as Ve,p as $,q as e,u as n,s as z,t as c,v as Be,x as Me,F as E,y as K,z as Pe,A as we}from"./entry.96dcb5a5.js";import{_ as $e,a as Ee}from"./subtitle.9c1ef04a.js";import{_ as Ue}from"./color-text.c62cd1fa.js";import{g as Ae,_ as Fe}from"./base64.cc0936a9.js";import{C as Re,_ as Le}from"./chip-folder.13649995.js";import{u as De,N as Q,a as Te,M as W,_ as je}from"./megaman-status.9020c247.js";import{u as qe,_ as Ge}from"./master-patch-card.3f2e52d8.js";import"./VDataTable.966ca9a1.js";const He={};function Je(U,C){const V=d("v-btn");return I(),Y(V,{color:"red"},{default:a(()=>[Ne(U.$slots,"default")]),_:3})}const Oe=X(He,[["render",Je]]),Ke=["href"],Qe=80,We=ke({__name:"abstract",setup(U){const C=Se(),V=ze(),Z=Ie(),t=p(()=>C.selectedBuild),y=m(),x=m([]),b=m(),N=m(!1),k=m(!1),ee=De(),ae=p(()=>ee.programs),v=m(new Q),te=p(()=>v.value.cells),le=p(()=>v.value.registeredNaviCustomizerPrograms),B=m(new Re),A=m(0),F=m([]),ue=p(()=>F.value.map(o=>B.value.chips.find(_=>_.id===o))),R=Te(),L=qe(),S=m([]),f=m(new W),oe=p(()=>{let o=0;return S.value.forEach(l=>{l.isActive&&(o+=Number(l.capacity))}),o}),ne=()=>{t.value&&(S.value=t.value.patchCards.map(o=>{const l=L.getCardById(o.id);if(!l)return null;const _=l.clone();return o.isActive||_.toggleActive(),_}).filter(o=>o!==null))},se=[{key:"G",name:"グレイガ"},{key:"F",name:"ファルザー"}],D=()=>{t.value&&(v.value=new Q,t.value.registeredNaviCustomizerPrograms.forEach(o=>{v.value.addProgram(o)}))},re=()=>{t.value&&(B.value.chips=t.value.folderChips.map((o,l)=>({id:l+1,chipId:o.chipId,codeIndex:o.codeIndex})).filter(o=>o!==null),t.value.regularChipId&&(A.value=t.value.regularChipId),t.value.tagChipIds&&(F.value=t.value.tagChipIds))},T=()=>{!t.value||!t.value.id||(y.value=t.value.name,x.value=t.value.versions,b.value=t.value.hpMemoryNum,D(),re(),ne())};O(t,o=>{o&&T()},{deep:!0}),O(S,o=>{f.value=new W,t.value&&(f.value.hpMemoryNum=t.value.hpMemoryNum,D(),R.update(t.value.hpMemoryNum,v.value.registeredNaviCustomizerPrograms,v.value.cells),R.naviCustomizerStatus.megamanStatus.abilities.forEach(l=>{f.value.abilities.push(l)}),o.forEach(l=>{l.isActive&&l.abilities.forEach(_=>{f.value.abilities.push(_)})}),f.value.apply())},{deep:!0}),Ve(()=>{L.fetchCards(),C.setSelectedBuildById(Z.params.id),t?T():V.push({path:"/"})});const ce=()=>{C.updateBuildById({id:t.value.id,name:y.value,versions:x.value,hpMemoryNum:b.value})},ie=()=>{N.value=!0},M=p(()=>{if(!t.value)return"";const{location:o}=window,l=we(),_=`${o.origin}${l.public.baseURL}`,u=[];return u.push(t.value.name),u.push(t.value.versions),u.push(t.value.hpMemoryNum),u.push(t.value.patchCards.length),t.value.patchCards.forEach(s=>{u.push(Number(s.id)),u.push(Number(s.isActive))}),u.push(t.value.folderChips.length),t.value.folderChips.forEach(s=>{u.push(s.id),u.push(Number(s.chipId)),u.push(s.codeIndex)}),u.push(t.value.regularChipId),u.push(t.value.tagChipIds),u.push(t.value.registeredNaviCustomizerPrograms.length),t.value.registeredNaviCustomizerPrograms.forEach(s=>{u.push(s.id),u.push(s.programId),u.push(Number(s.isCompressed)),u.push(s.rotate),u.push(s.y),u.push(s.x)}),`${_}share?key=${Ae.encode(JSON.stringify(u))}`}),de=()=>{navigator.clipboard.writeText(M.value)},_e=()=>{k.value=!0},me=()=>{C.deleteBuildById(t.value.id),V.push({path:"/"})};return(o,l)=>{const _=d("v-card-title"),u=be,s=Oe,j=d("v-card-actions"),P=d("v-card"),q=d("v-dialog"),pe=d("v-card-text"),ve=$e,r=d("v-row"),G=d("v-container"),h=Ee,H=d("v-text-field"),fe=d("v-checkbox"),g=d("v-col"),J=d("v-divider"),he=Ue,ge=Fe,Ce=Le,ye=je,xe=Ge;return I(),$(E,null,[e(G,null,{default:a(()=>[e(q,{modelValue:n(N),"onUpdate:modelValue":l[1]||(l[1]=i=>z(N)?N.value=i:null)},{default:a(()=>[e(P,null,{default:a(()=>[e(_,null,{default:a(()=>[c(" 本当に削除しますか？ ")]),_:1}),e(j,null,{default:a(()=>[e(u,{onClick:l[0]||(l[0]=i=>N.value=!1)},{default:a(()=>[c(" キャンセル ")]),_:1}),e(s,{color:"red",onClick:me},{default:a(()=>[c(" 削除する ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(q,{modelValue:n(k),"onUpdate:modelValue":l[3]||(l[3]=i=>z(k)?k.value=i:null)},{default:a(()=>[e(P,null,{default:a(()=>[e(_,null,{default:a(()=>[c(" 共有用URL ")]),_:1}),e(pe,null,{default:a(()=>[Be("a",{href:n(M),target:"_blank",rel:"noopener noreferrer"},Me(n(M)),9,Ke)]),_:1}),e(j,null,{default:a(()=>[e(u,{onClick:de},{default:a(()=>[c(" クリップボードにコピー ")]),_:1}),e(u,{onClick:l[2]||(l[2]=i=>k.value=!1)},{default:a(()=>[c(" 閉じる ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(ve,null,{default:a(()=>[c(" ビルド概要 ")]),_:1}),e(r,{class:"ma-0"},{default:a(()=>[e(u,{onClick:ce},{default:a(()=>[c(" 保存する ")]),_:1}),e(u,{class:"mr-auto ml-4",onClick:_e},{default:a(()=>[c(" 共有する ")]),_:1}),e(s,{onClick:ie},{default:a(()=>[c(" 削除する ")]),_:1})]),_:1})]),_:1}),e(G,{class:"pa-8"},{default:a(()=>[e(r,null,{default:a(()=>[e(h,null,{default:a(()=>[c(" ビルド名 ")]),_:1})]),_:1}),e(r,null,{default:a(()=>[e(H,{modelValue:n(y),"onUpdate:modelValue":l[4]||(l[4]=i=>z(y)?y.value=i:null)},null,8,["modelValue"])]),_:1}),e(r,{class:"mt-8"},{default:a(()=>[e(h,null,{default:a(()=>[c(" 対応バージョン ")]),_:1})]),_:1}),e(r,null,{default:a(()=>[(I(),$(E,null,K(se,i=>e(g,{key:i.key},{default:a(()=>[e(fe,{modelValue:n(x),"onUpdate:modelValue":l[5]||(l[5]=w=>z(x)?x.value=w:null),label:i.name,value:i.key},null,8,["modelValue","label","value"])]),_:2},1024)),64))]),_:1}),e(r,null,{default:a(()=>[e(h,null,{default:a(()=>[c(" HPメモリ ")]),_:1})]),_:1}),e(r,null,{default:a(()=>[e(H,{modelValue:n(b),"onUpdate:modelValue":l[6]||(l[6]=i=>z(b)?b.value=i:null),type:"number",max:"45",min:"0"},null,8,["modelValue"])]),_:1}),e(r,{class:"mt-8"},{default:a(()=>[e(J)]),_:1}),e(r,null,{default:a(()=>[e(h,null,{default:a(()=>[c(" ナビカスタマイザー ")]),_:1})]),_:1}),e(r,null,{default:a(()=>[e(g,{cols:"6",sm:"6"},{default:a(()=>[e(he,{cells:n(te)},null,8,["cells"])]),_:1}),e(g,{cols:"6",sm:"6"},{default:a(()=>[e(ge,{"registered-navi-customizer-programs":n(le),"master-navi-customizer-programs":n(ae)},null,8,["registered-navi-customizer-programs","master-navi-customizer-programs"])]),_:1})]),_:1}),e(r,{class:"mt-8"},{default:a(()=>[e(J)]),_:1}),e(r,null,{default:a(()=>[e(h,null,{default:a(()=>[c(" フォルダ ")]),_:1})]),_:1}),e(r,null,{default:a(()=>[e(g,{cols:"12"},{default:a(()=>[e(Ce,{"chip-folder":n(B),"regular-chip-id":n(A),"tag-chips":n(ue),"read-only":""},null,8,["chip-folder","regular-chip-id","tag-chips"])]),_:1})]),_:1}),e(r,null,{default:a(()=>[e(h,null,{default:a(()=>[c(" 改造カード ")]),_:1})]),_:1}),e(r,null,{default:a(()=>[e(g,{cols:"12"},{default:a(()=>[e(ye,{"megaman-status":n(f),"max-capacity":Qe,"current-capacity":n(oe)},null,8,["megaman-status","current-capacity"])]),_:1})]),_:1}),e(r,null,{default:a(()=>[e(g,{class:"pa-0"},{default:a(()=>[e(P,{class:Pe(["px-0 mt-4 mx-0",{"py-8":n(S).length===0}]),color:"primary"},{default:a(()=>[(I(!0),$(E,null,K(n(S),(i,w)=>(I(),Y(xe,{key:w,"patch-card":i,class:"ma-4"},null,8,["patch-card"]))),128))]),_:1},8,["class"])]),_:1})]),_:1})]),_:1})],64)}}});const na=X(We,[["__scopeId","data-v-6ee9ec68"]]);export{na as default};
