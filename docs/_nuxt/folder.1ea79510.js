import{_ as O,a as N}from"./subtitle.e3c1a556.js";import{_ as U}from"./accept.4c401071.js";import{a as V,b as E,c as L,u as z,C as G,_ as H}from"./chip-folder.cc4f2b2f.js";import{e as M,j as I,r as S,o as b,p as g,q as l,w as s,t as _,x as C,u as o,F as R,y as J,k as B,s as w,a as K,h as Q,i as W,f as X,l as Y,m as Z}from"./entry.2aacb420.js";import{V as ee}from"./VDataTable.121a0de6.js";const te={key:0},ae={key:1},le=M({__name:"battle-chip-master",props:{battleChip:{type:Object,required:!0},disabledAdd:{type:Boolean,default:!1}},emits:["on-click-chip-code"],setup(c,{emit:x}){const v=c,d=p=>E.chipClassToTextMap[p.class],e=I(()=>d(v.battleChip)),y=(p,r)=>{x("on-click-chip-code",p,r)};return(p,r)=>{const i=L,u=S("v-btn");return b(),g("tr",null,[l(i,{color:o(e)},{default:s(()=>[_(C(c.battleChip.number),1)]),_:1},8,["color"]),l(i,{color:o(e)},{default:s(()=>[_(C(o(V).chipClassToTextMap[c.battleChip.class]),1)]),_:1},8,["color"]),l(i,{color:o(e)},{default:s(()=>[_(C(c.battleChip.name),1)]),_:1},8,["color"]),l(i,{color:o(e),align:"text-right"},{default:s(()=>[_(C(c.battleChip.damage),1)]),_:1},8,["color"]),l(i,{color:o(e),align:"text-right"},{default:s(()=>[_(C(o(V).chipTypeToTextMap[c.battleChip.type]),1)]),_:1},8,["color"]),l(i,{color:o(e),align:"text-right"},{default:s(()=>[_(C(c.battleChip.capacity),1)]),_:1},8,["color"]),l(i,{color:o(e),align:"text-center"},{default:s(()=>[(b(!0),g(R,null,J(c.battleChip.codes,(n,t)=>(b(),g("span",{key:t},[l(u,{small:"",height:"100%",disabled:c.disabledAdd||n==="",onClick:h=>y(c.battleChip,t)},{default:s(()=>[n===""?(b(),g("span",te,"-")):(b(),g("span",ae,C(n),1))]),_:2},1032,["disabled","onClick"])]))),128))]),_:1},8,["color"])])}}}),oe=M({__name:"battle-chip-master",props:{chipFolder:{type:Object,required:!0},battleChips:{type:Array,required:!0}},emits:["add-battle-chip"],setup(c,{emit:x}){const v=c,d=B(""),e=B(30),y=[{title:"ナンバー",key:"number"},{title:"クラス",key:"class"},{title:"チップ名",key:"name"},{title:"威力",key:"damage"},{title:"系統",key:"type"},{title:"容量",key:"capacity"},{title:"コード",key:"codes"}],p=n=>n,r=(n,t)=>{x("add-battle-chip",n,t)},i=n=>{if(v.chipFolder.chips.length===30)return!0;const t=v.chipFolder.chips.filter(k=>k.chipId===n.id).length,{capacity:h}=n;return h<=20?t>=5:h<=30?t>=4:h<=40?t>=3:h<=50?t>=2:t>=1},u=(n,t)=>{r(n,t)};return(n,t)=>{const h=S("v-text-field"),k=le;return b(),g(R,null,[l(h,{modelValue:o(d),"onUpdate:modelValue":t[0]||(t[0]=m=>w(d)?d.value=m:null),"append-icon":"mdi-magnify",label:"検索","single-line":"","hide-details":""},null,8,["modelValue"]),l(o(ee),{"items-per-page":o(e),"onUpdate:itemsPerPage":t[1]||(t[1]=m=>w(e)?e.value=m:null),headers:y,items:c.battleChips,search:o(d),class:"elevation-1 table","multi-sort":"","show-current-page":"","items-per-page-text":"表示件数",density:"compact"},{item:s(m=>[l(k,{"battle-chip":p(m.item.selectable),"disabled-add":i(p(m.item.selectable)),onOnClickChipCode:u},null,8,["battle-chip","disabled-add"])]),_:2},1032,["items-per-page","items","search"])],64)}}});const ie=K(oe,[["__scopeId","data-v-240b0ff6"]]),de=M({__name:"folder",setup(c){const x=Q(),v=W(),d=X(),e=I(()=>d.selectedBuild),y=z(),p=I(()=>y.battleChips),r=B(new G),i=B(0),u=B([]),n=I(()=>u.value.map(a=>r.value.chips.find(T=>T.id===a))),t=()=>{e.value&&(r.value.chips=e.value.folderChips.map((a,f)=>({id:f+1,chipId:a.chipId,codeIndex:a.codeIndex})).filter(a=>a!==null),e.value.regularChipId&&(i.value=e.value.regularChipId),e.value.tagChipIds&&(u.value=e.value.tagChipIds))};Y(e,a=>{a&&t()},{deep:!0}),Z(()=>{y.fetchBattleChips(),d.setSelectedBuildById(v.params.id),e||x.push({path:"/"}),t()});const h=(a,f)=>{r.value.addBattleChip(a,f)},k=()=>{e.value&&d.updateBuildById({id:e.value.id,folderChips:r.value.chips,regularChipId:i.value,tagChipIds:u.value})},m=a=>{r.value.removeById(a)},$=a=>{if(i.value===a){i.value=0;return}i.value=a},A=a=>{if(u.value.includes(a)){u.value=u.value.filter(f=>f!==a);return}u.value.push(a)};return(a,f)=>{const T=O,q=U,F=S("v-container"),P=H,j=N,D=ie;return b(),g(R,null,[l(F,null,{default:s(()=>[l(T,null,{default:s(()=>[_(" フォルダ ")]),_:1}),l(q,{onClick:k},{default:s(()=>[_(" 保存する ")]),_:1})]),_:1}),l(F,null,{default:s(()=>[l(P,{"chip-folder":o(r),"regular-chip-id":o(i),"tag-chips":o(n),onClickRemove:m,onClickRegisterRegular:$,onClickRegisterTag:A},null,8,["chip-folder","regular-chip-id","tag-chips"])]),_:1}),l(F,null,{default:s(()=>[l(j,null,{default:s(()=>[_(" バトルチップ一覧 ")]),_:1}),l(D,{"battle-chips":o(p),"chip-folder":o(r),onAddBattleChip:h},null,8,["battle-chips","chip-folder"])]),_:1})],64)}}});export{de as default};
