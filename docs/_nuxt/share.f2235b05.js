import{_ as ie,a as de}from"./subtitle.9c1ef04a.js";import{_ as me}from"./color-text.c62cd1fa.js";import{g as pe,_ as _e}from"./base64.cc0936a9.js";import{C as ve,_ as fe}from"./chip-folder.13649995.js";import{u as he,N as G,a as ge,M as J,_ as Ce}from"./megaman-status.9020c247.js";import{u as ye,_ as Ne}from"./master-patch-card.3f2e52d8.js";import{e as xe,f as ze,h as Ie,i as Se,k as i,j as N,l as O,m as Pe,r as v,o as b,p as A,q as t,w as o,t as f,u as n,s as R,F as U,y as D,z as Me,c as be}from"./entry.96dcb5a5.js";import"./VDataTable.966ca9a1.js";const ke=80,qe=xe({__name:"share",setup(Ve){const K=ze(),Q=Ie(),W=Se(),l=i(null),x=i(),z=i([]),I=i(),X=he(),Y=N(()=>X.programs),h=i(new G),Z=N(()=>h.value.cells),ee=N(()=>h.value.registeredNaviCustomizerPrograms),k=i(new ve),$=i(0),q=i([]),ae=N(()=>q.value.map(e=>k.value.chips.find(u=>u.id===e))),H=ge(),L=ye(),C=i([]),g=i(new J),te=N(()=>{let e=0;return C.value.forEach(a=>{a.isActive&&(e+=Number(a.capacity))}),e}),oe=()=>{l.value&&(C.value=l.value.patchCards.map(e=>{const a=L.getCardById(e.id);if(!a)return null;const u=a.clone();return e.isActive||u.toggleActive(),u}).filter(e=>e!==null))},le=[{key:"G",name:"グレイガ"},{key:"F",name:"ファルザー"}],T=()=>{l.value&&(h.value=new G,l.value.registeredNaviCustomizerPrograms.forEach(e=>{h.value.addProgram(e)}))},se=()=>{l.value&&(k.value.chips=l.value.folderChips.map((e,a)=>({id:a+1,chipId:e.chipId,codeIndex:e.codeIndex})).filter(e=>e!==null),l.value.regularChipId&&($.value=l.value.regularChipId),l.value.tagChipIds&&(q.value=l.value.tagChipIds))},j=()=>{l.value&&(x.value=l.value.name,z.value=l.value.versions,I.value=l.value.hpMemoryNum,T(),se(),oe())};O(l,e=>{e&&j()},{deep:!0}),O(C,e=>{g.value=new J,l.value&&(g.value.hpMemoryNum=l.value.hpMemoryNum,T(),H.update(l.value.hpMemoryNum,h.value.registeredNaviCustomizerPrograms,h.value.cells),H.naviCustomizerStatus.megamanStatus.abilities.forEach(a=>{g.value.abilities.push(a)}),e.forEach(a=>{a.isActive&&a.abilities.forEach(u=>{g.value.abilities.push(u)})}),g.value.apply())},{deep:!0});const re=()=>{const e=JSON.parse(pe.decode(W.query.key));let a=0;const u=e[a++],S=e[a++],p=e[a++],s=e[a++],y=[];for(let c=0;c<s;c++){const _=String(e[a++]),r=!!e[a++],m={id:_,isActive:r};y.push(m)}const V=e[a++],d=[];for(let c=0;c<V;c++){const _=e[a++],r=String(e[a++]),m=e[a++],E={id:_,chipId:r,codeIndex:m};d.push(E)}const P=e[a++]??null,B=e[a++],M=[],w=e[a++];for(let c=0;c<w;c++){const _=e[a++],r=e[a++],m=!!e[a++],E=e[a++],ne=e[a++],ue=e[a++],ce={id:_,programId:r,isCompressed:m,rotate:E,y:ne,x:ue};M.push(ce)}const F={name:u,versions:S,hpMemoryNum:p,patchCards:y,folderChips:d,regularChipId:P,tagChipIds:B,registeredNaviCustomizerPrograms:M};l.value=F};return Pe(()=>{re(),L.fetchCards(),K.setSelectedBuildById(null),l?j():Q.push({path:"/"})}),(e,a)=>{const u=ie,S=v("v-container"),p=de,s=v("v-row"),y=v("v-text-field"),V=v("v-checkbox"),d=v("v-col"),P=v("v-divider"),B=me,M=_e,w=fe,F=Ce,c=Ne,_=v("v-card");return b(),A(U,null,[t(S,null,{default:o(()=>[t(u,null,{default:o(()=>[f(" ビルド概要 ")]),_:1})]),_:1}),t(S,{class:"pa-8"},{default:o(()=>[t(s,null,{default:o(()=>[t(p,null,{default:o(()=>[f(" ビルド名 ")]),_:1})]),_:1}),t(s,null,{default:o(()=>[t(y,{modelValue:n(x),"onUpdate:modelValue":a[0]||(a[0]=r=>R(x)?x.value=r:null),readonly:""},null,8,["modelValue"])]),_:1}),t(s,{class:"mt-8"},{default:o(()=>[t(p,null,{default:o(()=>[f(" 対応バージョン ")]),_:1})]),_:1}),t(s,null,{default:o(()=>[(b(),A(U,null,D(le,r=>t(d,{key:r.key},{default:o(()=>[t(V,{modelValue:n(z),"onUpdate:modelValue":a[1]||(a[1]=m=>R(z)?z.value=m:null),label:r.name,value:r.key,readonly:""},null,8,["modelValue","label","value"])]),_:2},1024)),64))]),_:1}),t(s,null,{default:o(()=>[t(p,null,{default:o(()=>[f(" HPメモリ ")]),_:1})]),_:1}),t(s,null,{default:o(()=>[t(y,{modelValue:n(I),"onUpdate:modelValue":a[2]||(a[2]=r=>R(I)?I.value=r:null),type:"number",max:"45",min:"0",readonly:""},null,8,["modelValue"])]),_:1}),t(s,{class:"mt-8"},{default:o(()=>[t(P)]),_:1}),t(s,null,{default:o(()=>[t(p,null,{default:o(()=>[f(" ナビカスタマイザー ")]),_:1})]),_:1}),t(s,null,{default:o(()=>[t(d,{cols:"6",sm:"6"},{default:o(()=>[t(B,{cells:n(Z)},null,8,["cells"])]),_:1}),t(d,{cols:"6",sm:"6"},{default:o(()=>[t(M,{"registered-navi-customizer-programs":n(ee),"master-navi-customizer-programs":n(Y)},null,8,["registered-navi-customizer-programs","master-navi-customizer-programs"])]),_:1})]),_:1}),t(s,{class:"mt-8"},{default:o(()=>[t(P)]),_:1}),t(s,null,{default:o(()=>[t(p,null,{default:o(()=>[f(" フォルダ ")]),_:1})]),_:1}),t(s,null,{default:o(()=>[t(d,{cols:"12"},{default:o(()=>[t(w,{"chip-folder":n(k),"regular-chip-id":n($),"tag-chips":n(ae),"read-only":""},null,8,["chip-folder","regular-chip-id","tag-chips"])]),_:1})]),_:1}),t(s,null,{default:o(()=>[t(p,null,{default:o(()=>[f(" 改造カード ")]),_:1})]),_:1}),t(s,null,{default:o(()=>[t(d,{cols:"12"},{default:o(()=>[t(F,{"megaman-status":n(g),"max-capacity":ke,"current-capacity":n(te)},null,8,["megaman-status","current-capacity"])]),_:1})]),_:1}),t(s,null,{default:o(()=>[t(d,{class:"pa-0"},{default:o(()=>[t(_,{class:Me(["px-0 mt-4 mx-0",{"py-8":n(C).length===0}]),color:"primary"},{default:o(()=>[(b(!0),A(U,null,D(n(C),(r,m)=>(b(),be(c,{key:m,"patch-card":r,class:"ma-4"},null,8,["patch-card"]))),128))]),_:1},8,["class"])]),_:1})]),_:1})]),_:1})],64)}}});export{qe as default};
