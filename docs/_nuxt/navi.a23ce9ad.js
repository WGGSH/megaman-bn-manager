import{_ as X,a as Y}from"./subtitle.c2c52f51.js";import{_ as Z}from"./accept.58c55faf.js";import{_ as ee,u as te,N as E,a as ae}from"./megaman-status.8b020cfa.js";import{e as I,r as c,o as p,c as R,w as t,s as e,m as z,p as q,f as V,u as i,y as O,t as h,A as L,x as W,F as U,q as G,l as j,z as re,h as F,v as oe,a as se,j as le,k as ne,i as ue}from"./entry.e8ff4339.js";import{C as ce,_ as ie}from"./color-text.681e70ab.js";import{V as me}from"./VDataTable.d3910fc0.js";const de=I({__name:"navi-customizer-status",props:{naviCustomizerStatus:{type:Object,required:!0}},setup(v){return(S,s)=>{const l=ee,g=c("v-card");return p(),R(g,{height:"100%"},{default:t(()=>[e(l,{"megaman-status":v.naviCustomizerStatus.megamanStatus,"max-capacity":0,"current-capacity":0},null,8,["megaman-status","max-capacity","current-capacity"])]),_:1})}}}),_e=I({__name:"navi-customizer-program",props:{programs:{type:Array,required:!0},selectedProgram:{type:Object,required:!1,default:null}},emits:["update-selected-program"],setup(v,{emit:S}){const s=v,l=z(""),g=z(10),o=z([]),y=[{title:"名前",key:"name",align:"center",sortable:!0},{title:"プログラムパーツ",key:"isProgram",align:"center",sortable:!0},{title:"色",key:"color",align:"center",sortable:!0}];return q(o,m=>{m.length===0?S("update-selected-program",null):S("update-selected-program",m[0])}),q(s,()=>{s.selectedProgram&&(o.value=[s.selectedProgram])}),(m,C)=>{const b=c("v-text-field"),f=c("v-icon");return p(),V(U,null,[e(b,{modelValue:i(l),"onUpdate:modelValue":C[0]||(C[0]=_=>O(l)?l.value=_:null),"append-icon":"mdi-magnify",label:"検索","single-line":"","hide-details":""},null,8,["modelValue"]),e(i(me),{modelValue:i(o),"onUpdate:modelValue":C[1]||(C[1]=_=>O(o)?o.value=_:null),"items-per-page":i(g),headers:y,items:v.programs,search:i(l),"item-value":"name",class:"elevation-1","multi-sort":"",density:"compact","show-select":"","return-object":"","select-strategy":"single"},{["item.isProgram"]:t(_=>[_.item.selectable.isProgram?(p(),R(f,{key:0},{default:t(()=>[h(" mdi-check ")]),_:1})):L("",!0)]),["item.color"]:t(_=>[h(W(i(ce).colorToTextMap[_.item.selectable.color]),1)]),_:2},1032,["modelValue","items-per-page","items","search"])],64)}}}),pe={class:"program"},ve=I({__name:"navi-customizer-program",props:{naviCustomizerProgram:{type:Object,required:!1,default:null}},emits:["update-program-state"],setup(v,{emit:S}){const s=v,l=z(0),g=z({isCompressed:!0,rotate:0});G(()=>{});const o=z(5),y=z(!0),m=j(()=>Math.max(s.naviCustomizerProgram.cells.length,s.naviCustomizerProgram.cells[0].length)),C=j(()=>{let P=0;switch(m.value){case 1:case 2:P=2;break;case 3:case 4:P=1;break;case 5:P=0;break;default:P=0;break}const k=[];for(let a=0;a<o.value;a++){const n=[];for(let u=0;u<o.value;u++)n.push(!1);k.push(n)}for(let a=0;a<s.naviCustomizerProgram.cells.length;a++)for(let n=0;n<s.naviCustomizerProgram.cells[a].length;n++){let u,d;switch(l.value){case 0:u=a,d=n;break;case 1:u=n,d=s.naviCustomizerProgram.cells[a].length-a-1;break;case 2:u=s.naviCustomizerProgram.cells[a].length-a-1,d=s.naviCustomizerProgram.cells[a].length-n-1;break;case 3:u=s.naviCustomizerProgram.cells[a].length-n-1,d=a;break;default:u=a,d=n;break}k[a+P][n+P]=y.value?s.naviCustomizerProgram.compressedCells[u][d]:s.naviCustomizerProgram.cells[u][d]}return k}),b=()=>{S("update-program-state",g.value)},f=()=>{l.value=(l.value+1)%4,g.value.rotate=l.value,b()},_=()=>{l.value=(l.value+3)%4,g.value.rotate=l.value,b()},T=()=>{g.value.isCompressed=y.value,b()};return(P,k)=>{const a=c("v-card-title"),n=c("v-switch"),u=c("v-row"),d=c("v-icon"),r=c("v-btn"),M=c("v-col"),B=c("v-card"),N=c("v-container");return p(),R(B,{class:"container pa-2",width:"100%",height:"100%"},{default:t(()=>[v.naviCustomizerProgram?(p(),V(U,{key:0},[e(a,null,{default:t(()=>[h(W(v.naviCustomizerProgram.name),1)]),_:1}),e(N,null,{default:t(()=>[e(u,null,{default:t(()=>[e(n,{modelValue:i(y),"onUpdate:modelValue":k[0]||(k[0]=w=>O(y)?y.value=w:null),label:"圧縮",onChange:T},null,8,["modelValue"])]),_:1}),e(u,{class:"mb-4"},{default:t(()=>[e(M,null,{default:t(()=>[e(r,{onClick:f},{default:t(()=>[e(d,null,{default:t(()=>[h(" mdi-rotate-left ")]),_:1})]),_:1})]),_:1}),e(M,{align:"right"},{default:t(()=>[e(r,{onClick:_},{default:t(()=>[e(d,null,{default:t(()=>[h(" mdi-rotate-right ")]),_:1})]),_:1})]),_:1})]),_:1}),re("div",pe,[(p(!0),V(U,null,F(i(C),(w,$)=>(p(),V("div",{key:$,class:"row"},[(p(!0),V(U,null,F(w,(x,A)=>(p(),V("div",{key:A,class:"col"},[e(B,{class:oe(["elevation-0 rounded-0 cell d-flex align-center justify-center",{filled:x}]),width:"100%",height:"100%",color:x?v.naviCustomizerProgram.color:"transparent"},{default:t(()=>[x&&!v.naviCustomizerProgram.isProgram?(p(),R(d,{key:0,color:"grey-darken-3",style:{"font-size":"70px",opacity:"20%"}},{default:t(()=>[h(" mdi-plus ")]),_:1})):L("",!0)]),_:2},1032,["class","color"])]))),128))]))),128))])]),_:1})],64)):(p(),R(a,{key:1},{default:t(()=>[h(" プログラムが選択されていません ")]),_:1}))]),_:1})}}});const ge=se(ve,[["__scopeId","data-v-3a002fef"]]),be=I({__name:"navi",setup(v){const S=le(),s=ne(),l=te(),g=j(()=>l.programs),o=z(new E),y=j(()=>o.value.cells),m=z(null),C=z({isCompressed:!0,rotate:0}),b=ue(),f=j(()=>b.selectedBuild),_=ae(),T=j(()=>_.naviCustomizerStatus),P=()=>{f.value&&(o.value=new E,f.value.registeredNaviCustomizerPrograms.forEach(r=>{o.value.addProgram(r)}))};q(f,r=>{r&&P()},{deep:!0}),q(o,r=>{r&&_.update(f.value.hpMemoryNum,r.registeredNaviCustomizerPrograms,r.cells)},{deep:!0}),G(()=>{l.fetchPrograms(),b.setSelectedBuildById(s.params.id),f||S.push({path:"/"}),P()});const k=()=>{f.value&&b.updateBuildById({id:f.value.id,registeredNaviCustomizerPrograms:o.value.registeredNaviCustomizerPrograms})},a=r=>{m.value=r},n=r=>{C.value=r},u=r=>{m.value&&o.value.addProgram({...C.value,id:o.value.registeredNaviCustomizerPrograms.length+1,programId:m.value.id,y:r.y,x:r.x})},d=r=>{const M=o.value.registeredNaviCustomizerPrograms.find(N=>N.id===r),B=g.value.find(N=>N.id===M.programId);o.value.removeProgram(r),m.value=B};return(r,M)=>{const B=X,N=Z,w=c("v-container"),$=de,x=c("v-col"),A=ie,D=c("v-row"),H=c("v-divider"),J=Y,K=_e,Q=ge;return p(),V(U,null,[e(w,null,{default:t(()=>[e(B,null,{default:t(()=>[h(" ナビカスタマイザー ")]),_:1}),e(N,{onClick:k},{default:t(()=>[h(" 保存する ")]),_:1})]),_:1}),e(w,null,{default:t(()=>[e(D,null,{default:t(()=>[e(x,{cols:"12",sm:"6"},{default:t(()=>[e($,{"navi-customizer-status":i(T)},null,8,["navi-customizer-status"])]),_:1}),e(x,{cols:"12",sm:"6"},{default:t(()=>[e(A,{cells:i(y),"selected-program":i(m),"program-state":i(C),onAddProgram:u,onRemoveProgram:d},null,8,["cells","selected-program","program-state"])]),_:1})]),_:1})]),_:1}),e(H),e(w,null,{default:t(()=>[e(J,null,{default:t(()=>[h(" プログラム一覧 ")]),_:1}),e(D,null,{default:t(()=>[e(x,{cols:"12",sm:"6"},{default:t(()=>[e(K,{programs:i(g),"selected-program":i(m),onUpdateSelectedProgram:a},null,8,["programs","selected-program"])]),_:1}),e(x,{cols:"12",sm:"6"},{default:t(()=>[e(Q,{"navi-customizer-program":i(m),onUpdateProgramState:n},null,8,["navi-customizer-program"])]),_:1})]),_:1})]),_:1})],64)}}});export{be as default};
