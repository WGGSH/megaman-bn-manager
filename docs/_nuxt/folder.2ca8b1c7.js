import{_ as N,a as U}from"./subtitle.c9b4825a.js";import{_ as E}from"./accept.872311fb.js";import{a as V,b as L,c as z,u as G,C as H,_ as J}from"./chip-folder.17157554.js";import{e as F,l as B,r as M,o as b,f as v,s as t,w as i,t as h,x as g,u as a,F as S,h as K,m as k,p as R,q as A,y as w,a as Q,j as W,k as X,i as Y}from"./entry.c56beb5c.js";import{V as Z}from"./VDataTable.9d55f6aa.js";const ee={key:0},te={key:1},le=F({__name:"battle-chip-master",props:{folderChip:{type:Object,required:!0},disabledAdd:{type:Boolean,default:!1}},emits:["on-click-chip-code"],setup(n,{emit:y}){const f=n,p=r=>L.chipClassToTextMap[r.class],s=B(()=>p(f.folderChip)),x=(r,c)=>{y("on-click-chip-code",r,c)};return(r,c)=>{const o=z,d=M("v-btn");return b(),v("tr",null,[t(o,{color:a(s)},{default:i(()=>[h(g(n.folderChip.number),1)]),_:1},8,["color"]),t(o,{color:a(s)},{default:i(()=>[h(g(a(V).chipClassToTextMap[n.folderChip.class]),1)]),_:1},8,["color"]),t(o,{color:a(s)},{default:i(()=>[h(g(n.folderChip.name),1)]),_:1},8,["color"]),t(o,{color:a(s),align:"text-right"},{default:i(()=>[h(g(n.folderChip.damage),1)]),_:1},8,["color"]),t(o,{color:a(s),align:"text-right"},{default:i(()=>[h(g(a(V).chipTypeToTextMap[n.folderChip.type]),1)]),_:1},8,["color"]),t(o,{color:a(s),align:"text-right"},{default:i(()=>[h(g(n.folderChip.capacity),1)]),_:1},8,["color"]),t(o,{color:a(s),align:"text-center"},{default:i(()=>[(b(!0),v(S,null,K(n.folderChip.codes,(e,u)=>(b(),v("span",{key:u},[t(d,{text:"",small:"",height:"100%",disabled:n.disabledAdd||e==="",onClick:m=>x(n.folderChip,u)},{default:i(()=>[e===""?(b(),v("span",ee,"-")):(b(),v("span",te,g(e),1))]),_:2},1032,["disabled","onClick"])]))),128))]),_:1},8,["color"])])}}}),ae=F({__name:"battle-chip-master",props:{chipFolder:{type:Object,required:!0},battleChips:{type:Array,required:!0}},emits:["add-battle-chip"],setup(n,{emit:y}){const f=n,p=k(""),s=k(30),x=[{title:"ナンバー",key:"number"},{title:"クラス",key:"class"},{title:"チップ名",key:"name"},{title:"威力",key:"damage"},{title:"系統",key:"type"},{title:"容量",key:"capacity"},{title:"コード",key:"codes"}];R(()=>f.battleChips,()=>{}),A(()=>{});const r=(d,e)=>{y("add-battle-chip",d,e)},c=(d,e)=>{r(d,e)},o=d=>{if(f.chipFolder.chips.length===30)return!0;const e=f.chipFolder.chips.filter(m=>m.chipId===d.id).length,{capacity:u}=d;return u<=20?e>=5:u<=30?e>=4:u<=40?e>=3:u<=50?e>=2:e>=1};return(d,e)=>{const u=M("v-text-field"),m=le;return b(),v(S,null,[t(u,{modelValue:a(p),"onUpdate:modelValue":e[0]||(e[0]=_=>w(p)?p.value=_:null),"append-icon":"mdi-magnify",label:"検索","single-line":"","hide-details":""},null,8,["modelValue"]),t(a(Z),{"items-per-page":a(s),"onUpdate:itemsPerPage":e[1]||(e[1]=_=>w(s)?s.value=_:null),headers:x,items:n.battleChips,search:a(p),class:"elevation-1 table","multi-sort":"","show-current-page":"","items-per-page-text":"表示件数",density:"compact"},{item:i(_=>[t(m,{"folder-chip":_.item.selectable,"disabled-add":o(_.item.selectable),onOnClickChipCode:c},null,8,["folder-chip","disabled-add"])]),_:2},1032,["items-per-page","items","search"])],64)}}});const oe=Q(ae,[["__scopeId","data-v-55484996"]]),de=F({__name:"folder",setup(n){const y=W(),f=X(),p=Y(),s=G(),x=B(()=>s.battleChips),r=k(new H),c=k(0),o=k([]),d=B(()=>o.value.map(l=>r.value.chips.find(I=>I.id===l))),e=B(()=>p.selectedBuild),u=(l,C)=>{r.value.addBattleChip(l,C)},m=()=>{e.value&&(r.value.chips=e.value.folderChips.map((l,C)=>({id:C+1,chipId:l.chipId,codeIndex:l.codeIndex})).filter(l=>l!==null),e.value.regularChipId&&(c.value=e.value.regularChipId),e.value.tagChipIds&&(o.value=e.value.tagChipIds))};R(e,l=>{l&&m()},{deep:!0}),A(()=>{s.fetchBattleChips(),p.setSelectedBuildById(f.params.id),e||y.push({path:"/"}),m()});const _=()=>{e.value&&p.updateBuildById({id:e.value.id,folderChips:r.value.chips,regularChipId:c.value,tagChipIds:o.value})},$=l=>{if(c.value===l){c.value=0;return}c.value=l},q=l=>{if(o.value.includes(l)){o.value=o.value.filter(C=>C!==l);return}o.value.push(l)};return(l,C)=>{const I=N,P=E,T=M("v-container"),j=J,D=U,O=oe;return b(),v(S,null,[t(T,null,{default:i(()=>[t(I,null,{default:i(()=>[h(" フォルダ ")]),_:1}),t(P,{onClick:_},{default:i(()=>[h(" 保存する ")]),_:1})]),_:1}),t(T,null,{default:i(()=>[t(j,{"chip-folder":a(r),"regular-chip-id":a(c),"tag-chips":a(d),onClickRegisterRegular:$,onClickRegisterTag:q},null,8,["chip-folder","regular-chip-id","tag-chips"])]),_:1}),t(T,null,{default:i(()=>[t(D,null,{default:i(()=>[h(" バトルチップ一覧 ")]),_:1}),t(O,{"battle-chips":a(x),"chip-folder":a(r),onAddBattleChip:u},null,8,["battle-chips","chip-folder"])]),_:1})],64)}}});export{de as default};
